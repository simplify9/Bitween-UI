import React, {Fragment, useState} from "react";
import {IoEnterOutline, IoExitOutline} from "react-icons/io5"
import {ExchangeDisplayStatus, ExchangeDisplayType} from "src/types/xchange";
import Pipe from "src/components/exchanges/ExchangeDataPipe";
import ExchangeDocumentModal from "src/components/exchanges/ExchangeDocumentModal";


interface Props {
    type: ExchangeDisplayType
    status: ExchangeDisplayStatus
    title: string
    icon?: React.ReactNode
    fileKey: string
    error: boolean
    completed: boolean
    bad?: boolean
}

const ExchangeDocument: React.FC<Props> = ({type, status, title, fileKey, bad, completed}) => {
    const [downloadUrl, setDownloadUrl] = useState<string | null>(null);

    const getIconClasses = () => {
        if (status == "good") {
            return "text-primary-green font-medium "
        }
        if (status == "bad") {
            return "text-yellow-400 font-medium "
        }
        if (status == "pending") {
            return "text-gray-400 font-medium "
        }
        if (status == "error") {
            return "text-red-500 font-medium "
        }
    }

    return (
        <Fragment>
            {
                Boolean(downloadUrl) &&
                <ExchangeDocumentModal downloadUrl={downloadUrl!} name={downloadUrl}
                                       onClose={() => setDownloadUrl(null)}/>
            }

            <div className={" z-10  text-grey-700  "}>
                <div
                    className={"flex     items-center justify-center   "}>
                    {
                        type == "receiver" && <div className={"flex flex-row items-center gap-1"}>
                            <IoEnterOutline className={"w-6 h-6 " + getIconClasses()}/>
                            <span className={"mx-1  " + getIconClasses()}>
                               {title}
                        </span>

                            <Pipe type={"Input"} onClick={() => setDownloadUrl(fileKey)} fileKey={fileKey}
                                  completed={true}/>

                        </div>
                    }
                    {
                        type == "mapper" && <div className={"flex flex-row items-center gap-1"}>
                            <svg width="24" height="24" viewBox="0 0 12 12" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path
                                    fill={status === "good" ? "#48BB78" : "rgb(239 68 68)"}
                                    d="M9.05013 6.96369C8.78222 6.96546 8.51803 7.02656 8.27655 7.1426C8.03507 7.25864 7.82229 7.42673 7.65351 7.6348L5.34092 6.56919C5.44965 6.23624 5.44965 5.87734 5.34092 5.54439L7.65351 4.47879C7.92631 4.80798 8.30663 5.03022 8.72735 5.10629C9.14806 5.18236 9.58212 5.10737 9.95293 4.89456C10.3237 4.68174 10.6074 4.34478 10.754 3.94315C10.9005 3.54151 10.9005 3.10102 10.7539 2.69941C10.6073 2.2978 10.3235 1.96089 9.95264 1.74814C9.5818 1.5354 9.14772 1.46049 8.72702 1.53663C8.30632 1.61278 7.92604 1.83509 7.6533 2.16433C7.38055 2.49357 7.23288 2.90857 7.23634 3.33609C7.2377 3.44412 7.24832 3.55183 7.26808 3.65804L4.87386 4.75993C4.61861 4.51034 4.29537 4.34162 3.94466 4.27493C3.59394 4.20823 3.23134 4.24651 2.90229 4.38498C2.57323 4.52345 2.29236 4.75594 2.09485 5.05333C1.89734 5.35073 1.79199 5.69979 1.79199 6.05679C1.79199 6.41379 1.89734 6.76286 2.09485 7.06025C2.29236 7.35764 2.57323 7.59013 2.90229 7.7286C3.23134 7.86707 3.59394 7.90535 3.94466 7.83865C4.29537 7.77196 4.61861 7.60325 4.87386 7.35366L7.26808 8.45554C7.24832 8.56175 7.2377 8.66946 7.23634 8.77749C7.23634 9.13622 7.34271 9.4869 7.54202 9.78518C7.74132 10.0835 8.0246 10.3159 8.35602 10.4532C8.68745 10.5905 9.05215 10.6264 9.40399 10.5564C9.75583 10.4865 10.079 10.3137 10.3327 10.06C10.5863 9.80637 10.7591 9.48319 10.8291 9.13134C10.8991 8.7795 10.8631 8.41481 10.7259 8.08338C10.5886 7.75195 10.3561 7.46867 10.0578 7.26937C9.75955 7.07007 9.40887 6.96369 9.05013 6.96369ZM9.05013 2.42919C9.2295 2.42919 9.40484 2.48238 9.55398 2.58203C9.70312 2.68169 9.81936 2.82332 9.888 2.98904C9.95664 3.15475 9.9746 3.3371 9.93961 3.51302C9.90462 3.68894 9.81824 3.85054 9.69141 3.97737C9.56458 4.1042 9.40298 4.19057 9.22706 4.22557C9.05114 4.26056 8.86879 4.2426 8.70308 4.17396C8.53736 4.10532 8.39573 3.98908 8.29608 3.83994C8.19642 3.6908 8.14324 3.51546 8.14324 3.33609C8.14324 3.09557 8.23878 2.8649 8.40886 2.69482C8.57894 2.52474 8.80961 2.42919 9.05013 2.42919ZM3.60874 6.96369C3.42937 6.96369 3.25403 6.9105 3.10489 6.81085C2.95575 6.7112 2.83951 6.56956 2.77087 6.40385C2.70223 6.23813 2.68427 6.05579 2.71926 5.87986C2.75426 5.70394 2.84063 5.54235 2.96746 5.41552C3.09429 5.28868 3.25589 5.20231 3.43181 5.16732C3.60773 5.13232 3.79008 5.15028 3.95579 5.21893C4.12151 5.28757 4.26315 5.40381 4.3628 5.55295C4.46245 5.70208 4.51564 5.87742 4.51564 6.05679C4.51564 6.29732 4.42009 6.52799 4.25001 6.69807C4.07994 6.86814 3.84926 6.96369 3.60874 6.96369ZM9.05013 9.68439C8.87077 9.68439 8.69543 9.6312 8.54629 9.53155C8.39715 9.4319 8.28091 9.29026 8.21227 9.12454C8.14363 8.95883 8.12567 8.77648 8.16066 8.60056C8.19565 8.42464 8.28203 8.26305 8.40886 8.13621C8.53569 8.00938 8.69729 7.92301 8.87321 7.88802C9.04913 7.85302 9.23148 7.87098 9.39719 7.93962C9.5629 8.00826 9.70454 8.1245 9.80419 8.27364C9.90384 8.42278 9.95703 8.59812 9.95703 8.77749C9.95703 9.01801 9.86149 9.24869 9.69141 9.41876C9.52133 9.58884 9.29066 9.68439 9.05013 9.68439Z"
                                />
                            </svg>
                            <span className={"mx-1  " + getIconClasses()}>
                               {title}
                        </span>

                            <Pipe type={"Mapper"} onClick={() => setDownloadUrl(fileKey)} fileKey={fileKey}
                                  bad={bad} completed={completed}/>

                        </div>
                    }

                    {
                        type == "skipped" && <div className={"flex flex-row items-center gap-1"}>
                            <svg className={"text-green-200"} width="24" height="24" viewBox="0 0 12 12" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path
                                    fill={"rgb(156,163,175)"}
                                    d="M9.05013 6.96369C8.78222 6.96546 8.51803 7.02656 8.27655 7.1426C8.03507 7.25864 7.82229 7.42673 7.65351 7.6348L5.34092 6.56919C5.44965 6.23624 5.44965 5.87734 5.34092 5.54439L7.65351 4.47879C7.92631 4.80798 8.30663 5.03022 8.72735 5.10629C9.14806 5.18236 9.58212 5.10737 9.95293 4.89456C10.3237 4.68174 10.6074 4.34478 10.754 3.94315C10.9005 3.54151 10.9005 3.10102 10.7539 2.69941C10.6073 2.2978 10.3235 1.96089 9.95264 1.74814C9.5818 1.5354 9.14772 1.46049 8.72702 1.53663C8.30632 1.61278 7.92604 1.83509 7.6533 2.16433C7.38055 2.49357 7.23288 2.90857 7.23634 3.33609C7.2377 3.44412 7.24832 3.55183 7.26808 3.65804L4.87386 4.75993C4.61861 4.51034 4.29537 4.34162 3.94466 4.27493C3.59394 4.20823 3.23134 4.24651 2.90229 4.38498C2.57323 4.52345 2.29236 4.75594 2.09485 5.05333C1.89734 5.35073 1.79199 5.69979 1.79199 6.05679C1.79199 6.41379 1.89734 6.76286 2.09485 7.06025C2.29236 7.35764 2.57323 7.59013 2.90229 7.7286C3.23134 7.86707 3.59394 7.90535 3.94466 7.83865C4.29537 7.77196 4.61861 7.60325 4.87386 7.35366L7.26808 8.45554C7.24832 8.56175 7.2377 8.66946 7.23634 8.77749C7.23634 9.13622 7.34271 9.4869 7.54202 9.78518C7.74132 10.0835 8.0246 10.3159 8.35602 10.4532C8.68745 10.5905 9.05215 10.6264 9.40399 10.5564C9.75583 10.4865 10.079 10.3137 10.3327 10.06C10.5863 9.80637 10.7591 9.48319 10.8291 9.13134C10.8991 8.7795 10.8631 8.41481 10.7259 8.08338C10.5886 7.75195 10.3561 7.46867 10.0578 7.26937C9.75955 7.07007 9.40887 6.96369 9.05013 6.96369ZM9.05013 2.42919C9.2295 2.42919 9.40484 2.48238 9.55398 2.58203C9.70312 2.68169 9.81936 2.82332 9.888 2.98904C9.95664 3.15475 9.9746 3.3371 9.93961 3.51302C9.90462 3.68894 9.81824 3.85054 9.69141 3.97737C9.56458 4.1042 9.40298 4.19057 9.22706 4.22557C9.05114 4.26056 8.86879 4.2426 8.70308 4.17396C8.53736 4.10532 8.39573 3.98908 8.29608 3.83994C8.19642 3.6908 8.14324 3.51546 8.14324 3.33609C8.14324 3.09557 8.23878 2.8649 8.40886 2.69482C8.57894 2.52474 8.80961 2.42919 9.05013 2.42919ZM3.60874 6.96369C3.42937 6.96369 3.25403 6.9105 3.10489 6.81085C2.95575 6.7112 2.83951 6.56956 2.77087 6.40385C2.70223 6.23813 2.68427 6.05579 2.71926 5.87986C2.75426 5.70394 2.84063 5.54235 2.96746 5.41552C3.09429 5.28868 3.25589 5.20231 3.43181 5.16732C3.60773 5.13232 3.79008 5.15028 3.95579 5.21893C4.12151 5.28757 4.26315 5.40381 4.3628 5.55295C4.46245 5.70208 4.51564 5.87742 4.51564 6.05679C4.51564 6.29732 4.42009 6.52799 4.25001 6.69807C4.07994 6.86814 3.84926 6.96369 3.60874 6.96369ZM9.05013 9.68439C8.87077 9.68439 8.69543 9.6312 8.54629 9.53155C8.39715 9.4319 8.28091 9.29026 8.21227 9.12454C8.14363 8.95883 8.12567 8.77648 8.16066 8.60056C8.19565 8.42464 8.28203 8.26305 8.40886 8.13621C8.53569 8.00938 8.69729 7.92301 8.87321 7.88802C9.04913 7.85302 9.23148 7.87098 9.39719 7.93962C9.5629 8.00826 9.70454 8.1245 9.80419 8.27364C9.90384 8.42278 9.95703 8.59812 9.95703 8.77749C9.95703 9.01801 9.86149 9.24869 9.69141 9.41876C9.52133 9.58884 9.29066 9.68439 9.05013 9.68439Z"
                                />
                            </svg>
                            <span className={"mx-1  " + getIconClasses()}>
                               {title}
                        </span>
                        </div>
                    }
                    {
                        type == "handler" && <div className={"flex flex-row items-center gap-1"}>
                          
                            <IoExitOutline className={"h-6 w-6 " + getIconClasses()}/>
                            <span className={"mx-1  " + getIconClasses()}>
                               {title}
                        </span>
                            <Pipe type={"handler"} bad={bad} completed={completed} onClick={() => setDownloadUrl(fileKey)}
                                  fileKey={fileKey}
                            />

                        </div>
                    }
                </div>
            </div>
        </Fragment>
    );
}

export default ExchangeDocument;
